
[repositories.spaces]
git = "https://github.com/work-spaces/spaces"
checkout = "Revision"
rev = "2f82e6399e7d4802be824ab66d61262bd1709075"

[actions]

build = [
    { name = "build", command = "cargo", working_directory = "spaces", arguments = [
        "build",
        "--profile=release",
    ] },
    { name = "mkdir", command = "mkdir", arguments = [
        "-p",
        "deploy",
    ] }
]

deploy = [
    { name = "build", command = "cargo", working_directory = "spaces", arguments = [
        "build",
        "--profile=dev",
    ] },
    { name = "mkdir", command = "mkdir", arguments = [
        "-p",
        "deploy",
    ] },
    { name = "archive", command = "spaces", arguments = [
        "create-binary-archive",
        "--name=spaces",
        "--version={SPACES_TOML:spaces/Cargo.toml/package.version}",
        "--output=deploy",
        "--input=spaces/target/release/spaces",
    ] },
    { name = "check_release", command = "gh", working_directory = "spaces", arguments = [
        "release",
        "view",
        "v{SPACES_TOML:spaces/Cargo.toml/package.version}",
        "--repo=https://github.com/work-spaces/spaces"
    ] },
    { name = "upload", command = "gh", working_directory = "spaces", arguments = [
        "release",
        "upload",
        "v{SPACES_TOML:spaces/Cargo.toml/package.version}",
        "../deploy/spaces-v{SPACES_TOML:spaces/Cargo.toml/package.version}-{SPACES_PLATFORM}.zip",
        "--repo=https://github.com/work-spaces/spaces"
    ] },
]